# 4. WebSockets

[WebFlux](https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html#webflux-websocket)

此部分参考文档涵盖对 Servlet 堆栈的支持，包括原始 WebSocket 交互的 WebSocket 消息传递，通过 SockJS 进行 WebSocket 仿真以及通过 STOMP 作为 WebSocket 的子协议进行发布、订阅消息传递。

## 4.1. WebSocket 概论

WebSocket 协议 [RFC 6455](https://tools.ietf.org/html/rfc6455) 提供了一种标准化方法，可通过单个TCP连接在客户端和服务器之间建立全双工双向通信通道。
它是与HTTP不同的TCP协议，但旨在通过端口80和443在HTTP上工作，并允许重复使用现有的防火墙规则。

### 4.1.1. HTTP 对比 WebSocket

### 4.1.2. 何时使用 WebSockets

## 4.2. WebSocket API

### 4.2.1. `WebSocketHandler`

### 4.2.2. WebSocket 握手

### 4.2.3. 部署

### 4.2.4. 服务端配置

### 4.2.5. 允许的来源

## 4.3. SockJS 回退

### 4.3.1. 概览

### 4.3.2. 启用 SockJS

### 4.3.3. IE8 与 IE9

### 4.3.4. 心跳

### 4.3.5. 客户端挂断

### 4.3.6. SockJS 与 CORS

### 4.3.7. `SockJsClient`

## 4.4. STOMP

### 4.4.1. 概览

### 4.4.2. 优点

### 4.4.3. 启用 STOMP

### 4.4.4. WebSocket 服务端

### 4.4.5. 消息流

### 4.4.6. 带注释的控制器

### 4.4.7. 发送消息

### 4.4.8. 简单代理

### 4.4.9. 外部代理

### 4.4.10. 连接到代理

### 4.4.11. 将点作为分隔符

### 4.4.12. 身份验证

### 4.4.13. 令牌（Token）验证

### 4.4.14. 用户目的地

### 4.4.15. 消息顺序

### 4.4.16. 事件

### 4.4.17. 拦截

### 4.4.18. STOMP 客户端

### 4.4.19. WebSocket 作用域

### 4.4.20. 性能

### 4.4.21. 监控

### 4.4.22. 测试
